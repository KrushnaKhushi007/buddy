{
  "name": "buddy",
  "description": "A simple build tool for js/css/html projects.",
  "version": "2.0.0-beta",
  "author": "popeindustries <alex@pope-industries.com>",
  "keywords": [
    "build",
    "buildtool",
    "modules",
    "javascript",
    "coffeescript",
    "css",
    "styus",
    "less",
    "handlebars",
    "dust",
    "jade",
    "twig"
  ],
  "dependencies": {
    "uglify-js": "2.4.13",
    "csso": "1.3.11",
    "eslint": "0.6.2",
    "csslint": "0.10.0",
    "lodash": "2.4.1",
    "recur-fs": "0.1.5",
    "buddy-cli": "0.10.0",
    "yaw": "0.1.1",
    "transfigure": "0.13.0",
    "identify-resource": "0.11.0",
    "inline-source": "0.6.0",
    "simple-browser-require": "0.2.x",
    "thunkify": "2.1.2",
    "co": "3.0.6",
    "portscanner": "0.2.3"
  },
  "devDependencies": {
    "should": "3.3.2",
    "mocha": "*",
    "rimraf": "*"
  },
  "directories": {
    "lib": "./lib"
  },
  "main": "index.js",
  "bin": {
    "buddy": "./bin/buddy"
  },
  "scripts": {
    "test": "NODE_ENV=test mocha --harmony --reporter spec --require should"
  },
  "engines": {
    "node": ">=0.11.9"
  },
  "repository": "git://github.com/popeindustries/buddy.git",
  "readmeFilename": "README.md",
  "readme": "[![Build Status](https://travis-ci.org/popeindustries/buddy.png)](https://travis-ci.org/popeindustries/buddy)\n\n# buddy(1)\n\n**buddy(1)** is a build tool for js/css/html projects. It helps you manage third-party dependencies (optional add-on), compiles source code from higher order js/css/html languages (CoffeeScript/Handlebars/Dust/Stylus/Less/Jade/Twig), automatically wraps js files in module definitions, statically resolves module dependencies, and concatenates (and optionally compresses) all souces into a single file for more efficient delivery to the browser.\n\n**Current version:** 1.3.3 *[See [Change Log](https://github.com/popeindustries/buddy/blob/master/CHANGELOG.md) for more details]*\n\n## Features\n\n- Allows you to write js __modules__ without the module boilerplate (similar to Node.js)\n- Resolves js module __dependencies__ automatically\n- Supports efficient ___lazy___ runtime evaluation by storing js modules as strings\n- Resolves all relative dependencies\n- __Compiles__ _CoffeeScript_, _Handlebars_, _Dust_, _Stylus_, _Less_, _Twig_, and _Jade_ source files\n- __Concatenates__ js modules into a single file\n- Runs js and css code through __linters__ to check for syntax errors\n- __Watches__ for source changes and builds automatically\n- [Add-on] __Serves__ static files from specified directory on specified port\n- [Add-on] __Refreshes__ connected browsers after each change\n- __Inlines__ css `@imports` automatically\n- __Inlines__ html `<script>` and `<link>` tags when flagged with `inline` attributes\n- __Inlines__ json content with `require(\"path/to/my.json\")`\n- Supports execution of a ___script___ after each build\n- Supports execution of ___hook___ scripts `afterEach` file is processed, and `before` and `after` a target is built\n\n## Installation\n\nTo avoid running **buddy(1)** directly as a global command, and thus avoid versioning problems across different projects, it is highly recommended that you instead install the separate [buddy-cli](https://github.com/popeindustries/buddy-cli) command line interface system-wide:\n\n```bash\n$ npm -g install buddy-cli\n```\n\n...run `buddy init` or manually create a *package.json* file for each project, locally installing **buddy** as a devDependency:\n\n```json\n{\n  \"name\": \"myproject\",\n  \"description\": \"This is my web project\",\n  \"version\": \"0.1.0\",\n  \"devDependencies\": {\n    \"buddy\": \"1.2.0\"\n  },\n  \"buddy\": {\n    ...\n  }\n}\n```\n```bash\n$ cd path/to/project\n$ npm install\n```\n\n## Usage\n\n```text\nUsage: buddy [options] <command> [path/to/package.json || path/to/buddy.js || path/to/buddy.json]\n\nCommands:\n\n  init                   set up a basic buddy project\n  install [config]       install dependencies [ADD-ON buddy-dependencies]\n  build [config]         build js and css sources\n  watch [config]         watch js and css source files and build changes\n  deploy [config]        build compressed js and css sources\n  ls                     list all previously created files and directories\n  clean                  remove all previously created files and directories\n\nOptions:\n\n  -h, --help             output usage information\n  -V, --version          output the version number\n  -t, --targets [types]  optional comma separated list of target(s) to build [js,css,html]\n  -c, --compress         compress output for production deployment\n  -l, --lint             check output for syntax and logic errors\n  -r, --reload           reload all connected live-reload clients on file change during watch [ADD-ON buddy-server]\n  -s, --serve            create a webserver to serve static files during watch [ADD-ON buddy-server]\n  -S, --script           run script on build completion\n  -L, --lazy             convert js modules for lazy evaluation\n  -v, --verbose          print all messages for debugging\n```\n\n## Configuration\n\nPlease refer to the annotated [buddy.js](https://github.com/popeindustries/buddy/blob/master/docs/buddy.js) configuration file for all possible configuration settings.\n\n## Build concepts\n\n**Project Root**: The directory from which all paths resolve to. Determined by location of the configuration file.\n\n**Sources**: An array of directories from which all referenced files are retrieved from. ***Note:*** A *js* module's id is derived from it's relative path to it's source directory.\n\n**Targets**: Objects that specify the *input* and *output* files or directories for each build. Targets are built in sequence, allowing builds to be chained together. ***Note:*** A *js* target can also have nested child targets, ensuring that dependencies are not duplicated across related builds.\n\n**Target parameters**:\n\n- **input**: file or directory to build. If js (or equivalent) file, all dependencies referenced will be concatenated together for output.\nIf directory, all compileable files will be compiled, wrapped in module definitions (js), and output to individual js/css files.\n\n- **output**: file or directory to output to.\n\n- **targets**: a nested target that prevents the duplication of source code with it's parent target.\n\n- **modular**: a flag to prevent js files from being wrapped with a module definition.\n\n- **output_compressed**: an alternate file or directory to use for compressed output.\n\n- **before**, **after**, **afterEach**: hooks for modifying the build process (see [hooks](https://github.com/popeindustries/buddy/#hooks))\n\n- **boilerplate**: a flag to specify inclusion of [browser-require](https://github.com/popeindustries/browser-require) source code in the output file\n\n- **bootstrap**: a flag to specify that the entry-point module be automatically `require`'d to force application startup\n\n### Hooks\n\nIt is possible to intervene in the build process through the use of *hooks*. Hooks are assigned to specific targets and defined in the target configuration. There are three types available:\n\n- **before**: executed before a *target* is built\n\n- **after**: executed after a *target* is built\n\n- **afterEach**: executed after an output *file* is processed, but before it is written to disk\n\nHooks can be written as inline JavaScript, or loaded from a file if a path is specified:\n\n```json\n{\n  ...\n  \"buddy\": {\n    \"js\": {\n      \"targets\": [\n        {\n          \"input\": \"somefile.js\",\n          \"output\": \"somedir\",\n          \"before\": \"console.log('before hook'); callback(null);\",\n          \"after\": \"path/to/afterHook.js\"\n        }\n      ]\n    }\n  }\n  ...\n}\n```\n\nAll hooks are passed the following arguments:\n\n- **context**: the `target` (before and after) or `file` (afterEach) instance\n\n- **options**: the runtime options used to execute buddy (`compress`, `lazy`, `reload`, `watch`, `deploy`, etc)\n\n- **callback**: a callback function that accepts an optional `error`. **MUST** be called in order to return control back to the program.\n\n### Aliases\n\nSpecifying aliases allow you to override the default behaviour for automatically resolving JS module ids. Aliases are defined in the target configuration:\n\n```json\n{\n  ...\n  \"buddy\": {\n    \"js\": {\n      \"targets\": [\n        {\n          \"input\": \"somefile.js\",\n          \"output\": \"somedir\",\n          \"alias\": {\n            \"jquery\": \"./lib/js/jquery-custom-2.0.js\",\n            \"dust\": \"./node_modules/dustjs-linkedin/dist/dust-core-1.2.3.js\"\n          }\n        }\n      ]\n    }\n  }\n}\n```\n```javascript\nvar jquery = require('jquery')\n  , dust = require('dust');\n```\n\n## Server\n\nWhen developing locally, the **buddy-server** add-on and `buddy watch --serve` command will start a simple webserver on `localhost` to test against. Adding the `--reload` flag will take it further by enabling automatic reloading of connected browsers through a [livereload](http://livereload.com) plugin.\n\nInstall the add-on alongside **buddy**, and see *[buddy-server](https://github.com/popeindustries/buddy-server)* for more info.\n\n```json\n{\n  \"dependencies\": {\n    \"buddy\": \"1.2.0\",\n    \"buddy-server\": \"0.4.3\"\n  },\n  ...\n  \"buddy\": {\n    \"server\": {\n      \"port\": 8000,\n      \"directory\": \"www\"\n    }\n    ...\n  }\n}\n```\n```bash\n$ buddy watch --serve --reload\n```\n\n## Working with JS\n\nEach JS file is wrapped in a module declaration based on the file's location. Dependencies are determined by the use of `require()` statements:\n\n```javascript\nvar lib = require('./my/lib'); // in current package\nvar SomeClass = require('../SomeClass'); // in parent package\nvar util = require('utils/util'); // from root package\nvar module = require('module'); // from node_modules\n\nlib.doSomething();\nvar something = new SomeClass();\nutil.log('hey');\n```\n\nSpecifying a module's public behaviour is achieved by decorating an `exports` object:\n\n```javascript\nvar myModuleVar = 'my module';\n\nexports.myModuleMethod = function() {\n  return myModuleVar;\n};\n```\n\n...or overwriting the `exports` object completely:\n\n```javascript\nfunction MyModule() {\n  this.myVar = 'my instance var';\n};\n\nMyModule.prototype.myMethod = function() {\n  return this.myVar;\n};\n\nmodule.exports = MyModule;\n```\n\nEach module is provided with a `module`, `exports`, and `require` reference.\n\nWhen `require()`-ing a module, keep in mind that the module id is resolved based on the following rules:\n\n * packages begin at the root folder specified in *build > js > sources*: `'Users/alex/project/src/package/main.js' > 'package/main'`\n * ids are case-sensitive: `'package/MyClass.js' > 'package/MyClass'`\n\nSee [node.js modules](http://nodejs.org/api/modules.html) for more info on modules.\n\n***NOTE***: `require()` boilerplate needs to be included in the browser to enable module loading. It's recommended to `install` a library like [browser-require](https://github.com/popeindustries/browser-require) (npm: simple-browser-require), or set the `boilerplate` flag to have it included automatically.\n\n#### PRECOMPILED TEMPLATES\n\n*dust*, *handlebars*, and *jade* support the precompilation of templates for efficient use in the browser. **buddy** precompiles the template source, wraps the content in a module definition, and exposes a `render()` method:\n\n```html\n<!-- src/js/template.dust -->\n{title}\n<ul>\n{#names}\n  <li>{name}</li>\n{/names}\n</ul>\n```\n```javascript\n// src/js/main.js\nvar template = require('./template')\n  , data = {\n    title: 'Friends',\n    names: [\n      {name: 'Joe'},\n      {name: 'Bob'},\n      {name: 'Annie'}\n    ]\n  };\n\ntemplate.render(data, function (err, html) {\n  // do something with html\n});\n```\n\n#### \"LAZY\" MODULES\n\nWhen run with the `--lazy` flag, **buddy** supports storing js modules as strings which are only evaluated on first `require('module')` call. This can significantly speed up application startup time for large bundles, especially on mobile devices.\n\n### EXAMPLES\n\nGenerate `www/main.js` by concatenating and modularizing all dependencies in `src/js` or `libs/js` referenced in `src/js/main.js`, including modules installed via npm (under `node_modules` directory):\n\n```json\n{\n  \"name\": \"myproject\",\n  \"description\": \"This is my web project\",\n  \"version\": \"0.1.0\",\n  \"devDependencies\": {\n    \"buddy\": \"1.2.0\"\n  },\n  \"buddy\": {\n    \"build\": {\n      \"js\": {\n        \"sources\": [\"src/js\", \"libs/js\"],\n        \"targets\": [\n          {\n            \"input\": \"src/js/main.js\",\n            \"output\": \"www/main.js\"\n          }\n        ]\n      }\n    }\n  }\n}\n```\n```javascript\n// src/main.js\nvar lodash = require('lodash') // npm module (node_modules/lodash)\n  , view = require('./views/view') // src module (src/views/view.js)\n  , util = require('utils/util'); // src module (libs/js/utils/util)\n```\n\nGenerate `www/main.js` and an additional widget `www/widget.js` using shared sources (avoid duplicating dependencies):\n\n```json\n{\n  ...\n  \"buddy\": {\n    \"build\": {\n      \"js\": {\n        \"sources\": [\"src/js\", \"libs/js\"],\n        \"targets\": [\n          {\n            \"input\": \"src/js/main.js\",\n            \"output\": \"www/main.js\",\n            \"targets\": [\n              {\n                \"input\": \"src/js/widget.js\",\n                \"output\": \"www/widget.js\"\n              }\n            ]\n          }\n        ]\n      }\n    }\n  }\n}\n```\n\nCompile a directory of CoffeeScript files for Node.js, skipping module wrapping and concatenation:\n\n```json\n{\n  ...\n  \"buddy\": {\n    \"build\": {\n      \"js\": {\n        \"sources\": [\"src/coffee\"],\n        \"targets\": [\n          {\n            \"input\": \"src/coffee\",\n            \"output\": \"js\",\n            \"modular\": false\n          }\n        ]\n      }\n    }\n  }\n}\n```\n\nAlias a custom build of **jquery**:\n\n```json\n{\n  ...\n  \"buddy\": {\n    \"build\": {\n      \"js\": {\n        \"sources\": [\"src/js\"],\n        \"targets\": [\n          {\n            \"input\": \"src/js/main.js\",\n            \"output\": \"www/main.js\",\n            \"alias\": {\n              \"jquery\": \"./lib/js/jquery-custom-2.0.js\"\n            }\n          }\n        ]\n      }\n    }\n  }\n}\n```\n```javascript\nvar jquery = require('jquery');\n```\n\nGenerate `www/main.js` by including `require()` boilerplate and automatically bootstraping (`require('main')`) the application:\n\n```json\n{\n  ...\n  \"buddy\": {\n    \"build\": {\n      \"js\": {\n        \"sources\": [\"src/js\"],\n        \"targets\": [\n          {\n            \"input\": \"src/js/main.js\",\n            \"output\": \"www/main.js\",\n            \"boilerplate\": true,\n            \"bootstrap\": true\n          }\n        ]\n      }\n    }\n  }\n}\n```\n\n## Working with CSS\n\nLike JS modules, CSS dependencies are automatically resolved through parsing and inlining of `@import` directives.\n\n### Examples\n\nGenerate `www/main.css` by concatenating all dependencies in `src/css` referenced in `src/css/main.css`:\n\n```json\n{\n  ...\n  \"buddy\": {\n    \"build\": {\n      \"css\": {\n        \"sources\": [\"src/css\"],\n        \"targets\": [\n          {\n            \"input\": \"src/css/main.css\",\n            \"output\": \"www/main.css\"\n          }\n        ]\n      }\n    }\n  }\n}\n```\n\n## Working with HTML\n\nWhen working with *dust*, *handlebars*, or *jade* templates, dependencies (partials, includes) are automatically resolved and registered before source files are compiled to HTML. In addition, HTML files are parsed for inlineable JS and CSS sources.\n\n### Examples\n\nResolve template partials:\n\n```html\n<!-- layout.handlebars depends on header.handlebars -->\n{{> header}}\n<body>\n  ...\n  <!-- ...and footer.handlebars -->\n  {{> footer}}\n</body>\n```\n\nInline JS and CSS source files with `inline` attribute:\n\n```html\n<!-- project/src/html/index.html -->\n<!DOCTYPE html>\n<html>\n<head>\n  <!-- inline project/src/js/inlineScript.js -->\n  <script inline src=\"../js/inlineScript.js\"></script>\n  <!-- inline project/scripts/inlineScript.js -->\n  <script inline src=\"/scripts/inlineScript.js\"></script>\n  <!-- inline project/src/css/inlineStyle.css -->\n  <link inline rel=\"../css/inlineStyle.css\"></link>\n</head>\n</html>\n```\n\n## License\n\n(The MIT License)\n\nCopyright (c) 2011-2014 Pope-Industries &lt;alex@pope-industries.com&gt;\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the 'Software'), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED 'AS IS', WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n",
  "license": "MIT"
}
